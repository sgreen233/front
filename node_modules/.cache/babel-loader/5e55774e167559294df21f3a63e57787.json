{"remainingRequest":"D:\\software\\front\\front\\node_modules\\babel-loader\\lib\\index.js!D:\\software\\front\\front\\src\\api\\file.js","dependencies":[{"path":"D:\\software\\front\\front\\src\\api\\file.js","mtime":1715830117995},{"path":"D:\\software\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1715830111371},{"path":"D:\\software\\front\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1715830110683}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgX3R5cGVvZiBmcm9tICJEOi9zb2Z0d2FyZS9mcm9udC9mcm9udC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mIjsKaW1wb3J0IHJlcXVlc3QgZnJvbSAnQC91dGlscy9yZXF1ZXN0JzsKZXhwb3J0IGRlZmF1bHQgewogIHVwbG9hZDogdXBsb2FkLAogIGRlbGV0ZUZpbGU6IGRlbGV0ZUZpbGUsCiAgZG93bmxvYWRGaWxlOiBkb3dubG9hZEZpbGUsCiAgZ2V0UHJvZ3Jlc3NQZXJjZW50OiBnZXRQcm9ncmVzc1BlcmNlbnQKfTsKdmFyIG5vd1Byb2dyZXNzUGVyY2VudCA9IDA7Ci8qDQogKiDmlofku7bkuIrkvKAt5LiK5Lyg5YiwcHVibGljDQogKiBAcGFyYW0gZmlsZQ0KICogQHBhcmFtIHRhYk5hbWUNCiAqIEBwYXJhbSByZWxJZHMNCiAqLwoKZnVuY3Rpb24gdXBsb2FkKHBhcmFtcykgewogIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogIE9iamVjdC5rZXlzKHBhcmFtcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBpZiAoX3R5cGVvZihwYXJhbXNba2V5XSkgPT09ICdvYmplY3QnKSB7CiAgICAgIE9iamVjdC5rZXlzKHBhcmFtc1trZXldKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXlzKSB7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlcycsIHBhcmFtc1trZXldW2tleXNdKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCBwYXJhbXNba2V5XSk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlcXVlc3QoewogICAgdXJsOiAnL2NvbW1vbi9taW5pby91cGxvYWQnLAogICAgbWV0aG9kOiAncG9zdCcsCiAgICBkYXRhOiBmb3JtRGF0YSwKICAgIG9uVXBsb2FkUHJvZ3Jlc3M6IGZ1bmN0aW9uIG9uVXBsb2FkUHJvZ3Jlc3MocHJvZ3Jlc3NFdmVudCkgewogICAgICBub3dQcm9ncmVzc1BlcmNlbnQgPSBwcm9ncmVzc0V2ZW50LmxvYWRlZCAvIHByb2dyZXNzRXZlbnQudG90YWwgKiA5OSB8IDA7CiAgICB9CiAgfSk7Cn0KCmZ1bmN0aW9uIGdldFByb2dyZXNzUGVyY2VudCgpIHsKICByZXR1cm4gbm93UHJvZ3Jlc3NQZXJjZW50Owp9CgpmdW5jdGlvbiBkZWxldGVGaWxlKGZpbGVJZHMpIHsKICByZXR1cm4gcmVxdWVzdC5kZWxldGUoIi9jb21tb24vbWluaW8vZGVsZXRlRmlsZT9vc3NGaWxlSWRzPSIuY29uY2F0KGZpbGVJZHMpKTsKfSAvLyBvc3Pmlofku7bmtYHkuIvovb1vc3MteWt0CgoKZnVuY3Rpb24gZG93bmxvYWRGaWxlKGlkLCBmaWxlU2l6ZSkgewogIHJldHVybiByZXF1ZXN0KHsKICAgIHVybDogJy9jb21tb24vbWluaW8vZG93bmxvYWRGaWxlJywKICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgZGF0YTogewogICAgICBpZDogaWQKICAgIH0sCiAgICByZXNwb25zZVR5cGU6ICdibG9iJywKICAgIG9uRG93bmxvYWRQcm9ncmVzczogZnVuY3Rpb24gb25Eb3dubG9hZFByb2dyZXNzKHByb2dyZXNzKSB7CiAgICAgIG5vd1Byb2dyZXNzUGVyY2VudCA9IE1hdGgucm91bmQoMTAwICogcHJvZ3Jlc3MubG9hZGVkIC8gZmlsZVNpemUpOwogICAgfQogIH0pOwp9"},{"version":3,"sources":["D:/software/front/front/src/api/file.js"],"names":["request","upload","deleteFile","downloadFile","getProgressPercent","nowProgressPercent","params","formData","FormData","Object","keys","forEach","key","append","url","method","data","onUploadProgress","progressEvent","loaded","total","fileIds","delete","id","fileSize","responseType","onDownloadProgress","progress","Math","round"],"mappings":";;;;AAAA,OAAOA,OAAP,MAAoB,iBAApB;AAEA,eAAe;AACbC,EAAAA,MAAM,EAANA,MADa;AAEbC,EAAAA,UAAU,EAAVA,UAFa;AAGbC,EAAAA,YAAY,EAAZA,YAHa;AAIbC,EAAAA,kBAAkB,EAAlBA;AAJa,CAAf;AAOA,IAAIC,kBAAkB,GAAG,CAAzB;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASJ,MAAT,CAAgBK,MAAhB,EAAwB;AACtB,MAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAC,EAAAA,MAAM,CAACC,IAAP,CAAYJ,MAAZ,EAAoBK,OAApB,CAA4B,UAAAC,GAAG,EAAI;AACjC,QAAI,QAAQN,MAAM,CAACM,GAAD,CAAd,MAAyB,QAA7B,EAAuC;AACrCH,MAAAA,MAAM,CAACC,IAAP,CAAYJ,MAAM,CAACM,GAAD,CAAlB,EAAyBD,OAAzB,CAAiC,UAAAD,IAAI,EAAI;AACvCH,QAAAA,QAAQ,CAACM,MAAT,CAAgB,OAAhB,EAAyBP,MAAM,CAACM,GAAD,CAAN,CAAYF,IAAZ,CAAzB;AACD,OAFD;AAGD,KAJD,MAIO;AACLH,MAAAA,QAAQ,CAACM,MAAT,CAAgBD,GAAhB,EAAqBN,MAAM,CAACM,GAAD,CAA3B;AACD;AACF,GARD;AASA,SAAOZ,OAAO,CAAC;AACbc,IAAAA,GAAG,EAAE,sBADQ;AAEbC,IAAAA,MAAM,EAAE,MAFK;AAGbC,IAAAA,IAAI,EAAET,QAHO;AAIbU,IAAAA,gBAAgB,EAAE,0BAAAC,aAAa,EAAI;AACjCb,MAAAA,kBAAkB,GAAIa,aAAa,CAACC,MAAd,GAAuBD,aAAa,CAACE,KAArC,GAA6C,EAA7C,GAAkD,CAAxE;AACD;AANY,GAAD,CAAd;AAQD;;AAED,SAAShB,kBAAT,GAA8B;AAC5B,SAAOC,kBAAP;AACD;;AAED,SAASH,UAAT,CAAoBmB,OAApB,EAA6B;AAC3B,SAAOrB,OAAO,CAACsB,MAAR,+CAAsDD,OAAtD,EAAP;AACD,C,CAED;;;AACA,SAASlB,YAAT,CAAsBoB,EAAtB,EAA0BC,QAA1B,EAAoC;AAClC,SAAOxB,OAAO,CAAC;AACbc,IAAAA,GAAG,EAAE,4BADQ;AAEbC,IAAAA,MAAM,EAAE,MAFK;AAGbC,IAAAA,IAAI,EAAE;AAAEO,MAAAA,EAAE,EAAEA;AAAN,KAHO;AAIbE,IAAAA,YAAY,EAAE,MAJD;AAKbC,IAAAA,kBALa,8BAKMC,QALN,EAKgB;AAC3BtB,MAAAA,kBAAkB,GAAGuB,IAAI,CAACC,KAAL,CAAW,MAAMF,QAAQ,CAACR,MAAf,GAAwBK,QAAnC,CAArB;AACD;AAPY,GAAD,CAAd;AASD","sourcesContent":["import request from '@/utils/request'\r\n\r\nexport default {\r\n  upload,\r\n  deleteFile,  \r\n  downloadFile,\r\n  getProgressPercent\r\n}\r\n\r\nvar nowProgressPercent = 0\r\n/*\r\n * 文件上传-上传到public\r\n * @param file\r\n * @param tabName\r\n * @param relIds\r\n */\r\nfunction upload(params) {\r\n  const formData = new FormData()    \r\n  Object.keys(params).forEach(key => {\r\n    if (typeof (params[key]) === 'object') {\r\n      Object.keys(params[key]).forEach(keys => {        \r\n        formData.append('files', params[key][keys])\r\n      })\r\n    } else {\r\n      formData.append(key, params[key])      \r\n    }\r\n  })  \r\n  return request({\r\n    url: '/common/minio/upload',\r\n    method: 'post',\r\n    data: formData,\r\n    onUploadProgress: progressEvent => {\r\n      nowProgressPercent = (progressEvent.loaded / progressEvent.total * 99 | 0)\r\n    }\r\n  })\r\n}\r\n\r\nfunction getProgressPercent() {\r\n  return nowProgressPercent\r\n}\r\n\r\nfunction deleteFile(fileIds) {\r\n  return request.delete(`/common/minio/deleteFile?ossFileIds=${fileIds}`)\r\n}\r\n\r\n// oss文件流下载oss-ykt\r\nfunction downloadFile(id, fileSize) {\r\n  return request({\r\n    url: '/common/minio/downloadFile',\r\n    method: 'post',\r\n    data: { id: id },\r\n    responseType: 'blob',\r\n    onDownloadProgress(progress) {\r\n      nowProgressPercent = Math.round(100 * progress.loaded / fileSize)\r\n    }\r\n  })  \r\n}\r\n\r\n"]}]}