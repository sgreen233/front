{"remainingRequest":"D:\\software\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\software\\front\\src\\components\\DataTableList.vue?vue&type=style&index=0&id=1376a7fc&scoped=true&lang=scss&","dependencies":[{"path":"D:\\software\\front\\src\\components\\DataTableList.vue","mtime":1682601378997},{"path":"D:\\software\\front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\software\\front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\software\\front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\software\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLy8gQGltcG9ydCAifkAvYXNzZXRzL2Nzcy92YXJpYWJsZXMuc2NzcyI7DQovLyAucHJpbWFyeSB7DQovLyAgIGJhY2tncm91bmQtY29sb3I6ICQtLWNvbG9yLXByaW1hcnk7DQovLyAgIGJvcmRlci1jb2xvcjogJC0tY29sb3ItcHJpbWFyeTsNCi8vICAgJjpob3ZlciB7DQovLyAgICAgb3BhY2l0eTogMC44Ow0KLy8gICB9DQovLyB9DQovLyA6OnYtZGVlcCAuZWwtY2FyZF9fYm9keSB7DQovLyAgIHBhZGRpbmc6IDA7DQovLyB9DQovLyAuY3VyZC1vcHRzIHsNCi8vICAgZGlzcGxheTogLXdlYmtpdC1mbGV4Ow0KLy8gICBkaXNwbGF5OiBmbGV4Ow0KLy8gICBhbGlnbi1pdGVtczogY2VudGVyOw0KLy8gICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQovLyAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQovLyB9DQoNCi8vIC5jb2xvci15ZWxsb3cgew0KLy8gICBjb2xvcjogI2ZmYjQwMDsNCi8vIH0NCi8vIC5jb2xvci1yZWQgew0KLy8gICBjb2xvcjogI2Y1NTg1ZjsNCi8vIH0NCi8vIC5jb2xvci1ncmVlbiB7DQovLyAgIGNvbG9yOiAjMDA5MTQwOw0KLy8gfQ0KLy8gLmNvbG9yLWJsdWUgew0KLy8gICBjb2xvcjogIzE4OTBmZjsNCi8vIH0NCg0KLy8gLmJ1dHRvbi1ncm91cCB7DQovLyAgIGRpc3BsYXk6IGZsZXg7DQovLyAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCi8vICAgd2lkdGg6IDEwMCU7DQovLyB9DQoNCi8vIC5jaGVja2JveC1pdGVtOm50aC1sYXN0LW9mLXR5cGUoMSkgew0KLy8gICBtYXJnaW4tcmlnaHQ6IDMwcHg7DQovLyB9DQovLyA="},{"version":3,"sources":["DataTableList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAioBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"DataTableList.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <DataTableHeader ref=\"dataTBLMother\" :selected-columns.sync=\"selectedColumns\" :default-props=\"defaultProps.defaultDTHProps\" @init-click=\"refreshInit\" @show-search=\"showSearchPanel\" @append-click=\"appendClick\" @edit-click=\"editClick\" @delete-click=\"deleteClick\" @audit-click=\"auditClick\" @export-click=\"exportClick\" @audit-on-change=\"auditOnChange\" @more1-click=\"more1Click\" @more2-click=\"more2Click\" @upload-finish=\"uploadFinish\">\r\n    <template slot=\"searchPanel\">\r\n      <!-- v-model=\"searchName\" -->\r\n      <slot name=\"searchPanel\"><BtnSearch :search-name=\"searchName\" :placeholder=\"searchPlaceholder\" :no-advanced-search=\"noAdvancedSearch\" :search-items=\"searchItems\" @search-click=\"searchClick\" @advanced-search-click=\"advancedSearchClick\" /></slot>\r\n    </template>\r\n    <template slot=\"body\">\r\n      <!--列表展示-->\r\n      <el-card shadow=\"never\">\r\n        <slot slot=\"header\" name=\"cardTitle\" />\r\n        <template v-if=\"title\" slot=\"header\">\r\n          <span>{{ title.mainTitle }}</span>\r\n          <span v-if=\"title.subTitle\">&nbsp;|&nbsp;<strong>{{ title.subTitle || \"全部\" }}</strong></span>\r\n        </template>\r\n        <el-table ref=\"table\" v-adaptive=\"{bottomOffset}\" v-loading=\"loading\" border height=\"100%\" :data=\"dataList\" row-key=\"id\" highlight-current-rows @current-change=\"handleColumnChange\" @selection-change=\"handleSelectionChange\" @sort-change=\"handleSortChange\">\r\n          <el-table-column v-if=\"checkFlag\" fixed :reserve-selection=\"true\" type=\"selection\" width=\"55\" />\r\n          <el-table-column v-else fixed width=\"55\">\r\n            <template slot-scope=\"scope\">\r\n              <el-radio v-model=\"tableRadio\" :label=\"scope.row\"><i /></el-radio>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column v-for=\"(item, index) in tableColumnItem\" :key=\"index\" :show-overflow-tooltip=\"true\" :prop=\"item.tableColumnName\" :label=\"item.showName\" :width=\"item.width\" :sortable=\"item.sortable?'custom':false\">\r\n            <template #default=\"scope\">\r\n              <!-- 特殊列格式 -->\r\n              <div v-if=\"item.tableColumnName.endsWith('Time')\">{{ scope.row[item.tableColumnName] | filterDateTime }}</div>\r\n              <div v-else-if=\"item.tableColumnName === 'isAudit'\">{{ scope.row[item.tableColumnName] | filterIsAudit }}</div>\r\n              <div v-else-if=\"item.tableColumnName === 'status'\">{{ scope.row[item.tableColumnName] | filterTeamStatus }}</div>\r\n              <div v-else-if=\"item.tableColumnName.endsWith('Status')\">{{ scope.row[item.tableColumnName] | filterPublishStatus }}</div>\r\n              <!-- 列表自定义显示的内容 tableColumnName 必须以 customize- 开头 -->\r\n              <slot v-else-if=\"item.tableColumnName.startsWith('customize-')\" :name=\"item.tableColumnName.replace('customize-','')\" :row=\"scope.row\" />\r\n              <div v-else>{{ scope.row[item.tableColumnName] || \"--\" }}</div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column v-if=\"operateShow\" fixed=\"right\" label=\"操作\" :width=\"operateWidth\">\r\n            <template #default=\"scope\">\r\n              <!--查看and编辑and删除-->\r\n              <el-button v-if=\"button.visible.show\" :type=\"button.visible.type\" size=\"mini\" :title=\"button.visible.name\" @click=\"view([scope.row])\">\r\n                <svg-icon icon-class=\"axt-view\" />\r\n              </el-button>\r\n              <el-button v-if=\"button.update.show\" :type=\"button.update.type\" icon=\"el-icon-edit\" size=\"mini\" :title=\"button.update.name\" @click=\"editClick(scope.row)\" />\r\n              <!--列表数据右方的操作按钮-->\r\n              <slot name=\"rightOperate\" :row=\"scope.row\" />\r\n              <el-button v-if=\"button.delete.show\" :type=\"button.delete.type\" icon=\"el-icon-delete\" size=\"mini\" :title=\"button.delete.name\" @click=\"remove([scope.row])\" />\r\n              <el-button v-if=\"button.up.show\" :type=\"button.up.type\" icon=\"el-icon-top\" size=\"mini\" :loading=\"buttonLoading.up\" :title=\"button.up.name\" @click=\"move(scope.row, true)\" />\r\n              <el-button v-if=\"button.down.show\" :type=\"button.down.type\" icon=\"el-icon-bottom\" size=\"mini\" :loading=\"buttonLoading.down\" :title=\"button.down.name\" @click=\"move(scope.row, false)\" />\r\n              <el-button v-if=\"button.audit.show\" :type=\"button.audit.type\" icon=\"el-icon-s-check\" size=\"mini\" :title=\"button.audit.name\" @click=\"auditClick([scope.row], null)\" />\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <v-page v-if=\"showPage\" align=\"center\" :total=\"totalSize\" :current-page=\"pageInfo.page\" :page-size=\"pageInfo.size\" :page-sizes=\"[25, 50, 75, 100]\" :selected-columns=\"selectedColumns\" @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\" />\r\n      </el-card>\r\n    </template>\r\n  </DataTableHeader>\r\n</template>\r\n\r\n<script>\r\n\r\nimport DataTableHeader from '@/components/DataTableHeader'\r\nimport listAPI from '@/api/list'\r\nimport BtnSearch from '@/components/BtnSearch'\r\n\r\nimport VPage from '@/components/Pagination'\r\nimport moment from 'moment'\r\nimport adaptive from '@/directive/el-table'\r\nimport CONSTANT from '@/constant'\r\nimport _ from 'lodash'\r\nexport default {\r\n  name: 'DataTableList',\r\n  components: { VPage, DataTableHeader, BtnSearch },\r\n  directives: { adaptive },\r\n  filters: {\r\n    filterDateTime(val) {\r\n      if (!val) {\r\n        return '--'\r\n      } else {\r\n        return moment(val).format('YYYY-MM-DD HH:mm')\r\n      }\r\n    },\r\n    filterIsAudit(val) { // 这个地方出现的constant，需要在本文件头部import constant，不知道原因\r\n      switch (val) {\r\n        case CONSTANT.AUDIT_STATUS.SUBMIT: return CONSTANT.AUDIT_STATUS.SUBMITNAME\r\n        case CONSTANT.AUDIT_STATUS.PASS: return CONSTANT.AUDIT_STATUS.PASSNAME\r\n        case CONSTANT.AUDIT_STATUS.NOTPASS: return CONSTANT.AUDIT_STATUS.NOTPASSNAME\r\n        case CONSTANT.AUDIT_STATUS.BACK: return CONSTANT.AUDIT_STATUS.BACKNAME\r\n        default: return CONSTANT.AUDIT_STATUS.SAVENAME\r\n      }\r\n    },\r\n    filterTeamStatus(val) {\r\n      switch (val) {\r\n        case 1: return '校赛'\r\n        case 2: return '省赛初赛'\r\n        case 3: return '省赛决赛'\r\n      }\r\n    },\r\n    filterPublishStatus(val) {\r\n      switch (val) {\r\n        case false: return '未发布'\r\n        case true: return '已发布'\r\n      }\r\n    }\r\n  },\r\n  props: {\r\n    defaultProps: { // 注意这里的默认值没有用，必须在create中再设置\r\n      type: Object,\r\n      default: () => {\r\n        return {\r\n          keyWord: { },\r\n          title: { mainTile: '', subTitle: '' },\r\n          bottomOffset: 0,\r\n          sortStr: { properties: 'Id', direction: 'DESC' }, // 排序方法\r\n          treeInfo: { },\r\n          someFlags: {\r\n            operateShow: true, // 最右边的按钮操作面板是否出现\r\n            checkFlag: true, // 是否出现最左边的checkBox\r\n            showPage: true, // 是否显示底部翻页\r\n            autoInit: true // 初始时是否显示数据\r\n          },\r\n          initSearchWords: { // 初始时查询的三个关键词\r\n            searchKey: { },\r\n            regKey: { },\r\n            andor: { }\r\n          },\r\n          nowSearchWords: { // 变化查询的三个关键词\r\n            searchKey: { },\r\n            regKey: { },\r\n            andor: { }\r\n          },\r\n          moveSearchWords: { // 用于上移下移时候的查询字\r\n            moveSearchKey: { },\r\n            moveRegKey: { }\r\n          },\r\n          searchPanel: {\r\n            name: '',\r\n            placeholder: ''\r\n          },\r\n          defaultDTHProps: {\r\n            // defaultDTHProps中的所有对象属性\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      usedSearchWords: { // 最终使用查询的三个关键词\r\n        searchKey: { },\r\n        regKey: { },\r\n        andor: { }\r\n      },\r\n      selectedColumns: [],\r\n      // loading: true,\r\n      // layout: 'total, sizes, prev, pager, next, jumper',\r\n      dataList: [],\r\n      pageInfo: { page: 1, size: 25 },\r\n      totalSize: 0,\r\n      tableColumnItem: [],\r\n      loading: false,\r\n      buttonLoading: { up: false, down: false },\r\n      tableRadio: null,\r\n      // 列表中的字体颜色\r\n      redArr: [],\r\n      greenArr: [],\r\n      blueArr: [],\r\n      yellowArr: [],\r\n\r\n      operateWidth: 60,\r\n      thisEvents: '',\r\n      isPageInit: false\r\n    }\r\n  },\r\n  computed: {\r\n    keyWord() {\r\n      return this.$refs.dataTBLMother.keyWord\r\n    },\r\n    title() {\r\n      return this.defaultProps.title ? this.defaultProps.title : null\r\n    },\r\n    button() {\r\n      return this.$refs.dataTBLMother.button\r\n    },\r\n    operateShow() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'someFlags')) {\r\n        if (Object.prototype.hasOwnProperty.call(this.defaultProps.someFlags, 'operateShow')) {\r\n          return this.defaultProps.someFlags.operateShow\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    checkFlag() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'someFlags')) {\r\n        if (Object.prototype.hasOwnProperty.call(this.defaultProps.someFlags, 'checkFlag')) {\r\n          return this.defaultProps.someFlags.checkFlag\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    noAdvancedSearch() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'someFlags')) {\r\n        if (Object.prototype.hasOwnProperty.call(this.defaultProps.someFlags, 'noAdvancedSearch')) {\r\n          return this.defaultProps.someFlags.noAdvancedSearch\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    showPage() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'someFlags')) {\r\n        if (Object.prototype.hasOwnProperty.call(this.defaultProps.someFlags, 'showPage')) {\r\n          return this.defaultProps.someFlags.showPage\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    autoInit() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'someFlags')) {\r\n        if (Object.prototype.hasOwnProperty.call(this.defaultProps.someFlags, 'autoInit')) {\r\n          return this.defaultProps.someFlags.autoInit\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    bottomOffset: {\r\n      get: function() {\r\n        return this.defaultProps.bottomOffset ? this.defaultProps.bottomOffset : 0\r\n      },\r\n      set: function() {\r\n        this.$forceUpdate()\r\n      }\r\n    },\r\n    searchItems() {\r\n      return this.defaultProps.searchItems ? this.defaultProps.searchItems : []\r\n    },\r\n    sortStr() {\r\n      return this.defaultProps.sortStr ? this.defaultProps.sortStr : { properties: 'Id', direction: 'DESC' }\r\n    },\r\n    initSearchWords() {\r\n      return this.defaultProps.initSearchWords ? this.defaultProps.initSearchWords : { }\r\n    },\r\n    nowSearchWords: {\r\n      get() {\r\n        return this.defaultProps.nowSearchWords ? this.defaultProps.nowSearchWords : { }\r\n      },\r\n      set(val) {\r\n\r\n      }\r\n    },\r\n    moveSearchWords() {\r\n      return this.defaultProps.moveSearchWords ? this.defaultProps.moveSearchWords : { }\r\n    },\r\n    treeInfo() {\r\n      return this.defaultProps.treeInfo ? this.defaultProps.treeInfo : {}\r\n    },\r\n    searchName() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'searchPanel')) {\r\n        return this.defaultProps.searchPanel.name ? this.defaultProps.searchPanel.name : ''\r\n      }\r\n      return ''\r\n    },\r\n    searchPlaceholder() {\r\n      if (Object.prototype.hasOwnProperty.call(this.defaultProps, 'searchPanel')) {\r\n        return this.defaultProps.searchPanel.placeholder ? this.defaultProps.searchPanel.placeholder : '请输入名称'\r\n      }\r\n      return '请输入名称'\r\n    }\r\n    // variables() {\r\n    //   return variables\r\n    // },\r\n    // colors() {\r\n    //   return eVariables\r\n    // }\r\n  },\r\n  watch: {\r\n    autoInit: {\r\n      handler(val) {\r\n        if (val) {\r\n          setTimeout(() => { this.initDataList() }, 500)\r\n        }\r\n      }\r\n    },\r\n    nowSearchWords: {\r\n      handler(val) {\r\n        if (this.autoInit) {\r\n          setTimeout(() => { this.initDataList() }, 500)\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    }\r\n  },\r\n  mounted() {\r\n    this.thisEvents = JSON.parse(JSON.stringify(this._events))\r\n    var btn = this.$refs.dataTBLMother.button\r\n    let num = 0\r\n    const arr = [\r\n      btn.visible.show,\r\n      btn.delete.show,\r\n      btn.update.show,\r\n      btn.up.show,\r\n      btn.down.show,\r\n      btn.audit.show\r\n    ]\r\n    num = arr.reduce((acc, cur) => {\r\n      acc = cur ? acc + 1 : acc\r\n      return acc\r\n    }, 0)\r\n\r\n    var width = num * 46\r\n    if (width < 60) {\r\n      width = 60\r\n    }\r\n    this.operateWidth = width\r\n\r\n    setTimeout(() => { this.initDataList() }, 500)\r\n  },\r\n  methods: {\r\n    // #region initDataList\r\n    getUsedSearchWords() {\r\n      this.$set(this.usedSearchWords, 'searchKey', {})\r\n      this.$set(this.usedSearchWords, 'regKey', {})\r\n      this.$set(this.usedSearchWords, 'andor', {})\r\n\r\n      if (Object.prototype.hasOwnProperty.call(this.initSearchWords, 'searchKey') && (Object.keys(this.initSearchWords.searchKey).length !== 0)) {\r\n        this.usedSearchWords.searchKey = _.cloneDeep(this.initSearchWords.searchKey)\r\n        if (Object.prototype.hasOwnProperty.call(this.initSearchWords, 'regKey') && (Object.keys(this.initSearchWords.regKey).length !== 0)) {\r\n          this.usedSearchWords.regKey = _.cloneDeep(this.initSearchWords.regKey)\r\n        }\r\n        if (Object.prototype.hasOwnProperty.call(this.initSearchWords, 'andor') && (Object.keys(this.initSearchWords.andor).length !== 0)) {\r\n          this.usedSearchWords.andor = _.cloneDeep(this.initSearchWords.andor)\r\n        }\r\n      }\r\n      if (Object.prototype.hasOwnProperty.call(this.nowSearchWords, 'searchKey') && (Object.keys(this.nowSearchWords.searchKey).length !== 0)) {\r\n        this.usedSearchWords.searchKey = _.merge(this.nowSearchWords.searchKey, this.initSearchWords.searchKey)\r\n        if (Object.prototype.hasOwnProperty.call(this.nowSearchWords, 'regKey') && (Object.keys(this.nowSearchWords.regKey).length !== 0)) {\r\n          this.usedSearchWords.regKey = _.merge(this.nowSearchWords.regKey, this.initSearchWords.regKey)\r\n        }\r\n        if (Object.prototype.hasOwnProperty.call(this.nowSearchWords, 'andor') && (Object.keys(this.nowSearchWords.andor).length !== 0)) {\r\n          this.usedSearchWords.andor = _.merge(this.nowSearchWords.andor, this.initSearchWords.andor)\r\n        }\r\n      }\r\n    },\r\n    async _initDataList() {\r\n      this.loading = true\r\n      try {\r\n        if (this.selectedColumns.length > 0 && !this.isPageInit) {\r\n          this.selectedColumns = this.selectedColumns.slice(0, 0)\r\n          this.$refs.table.clearSelection()\r\n        }\r\n        // 每次刷新前，都应该拼一下usedSearchWords\r\n        this.getUsedSearchWords()\r\n        var resp\r\n        try {\r\n          if (JSON.stringify(this.treeInfo) === '{}') {\r\n            resp = await listAPI.getSomeRecords({\r\n              keyWords: this.keyWord.view,\r\n              pageInfo: this.pageInfo,\r\n              treeInfo: null,\r\n              searchKey: this.usedSearchWords.searchKey,\r\n              sort: this.sortStr,\r\n              reg: this.usedSearchWords.regKey,\r\n              andor: this.usedSearchWords.andor\r\n            })\r\n          } else {\r\n            resp = await listAPI.getSomeRecords({\r\n              keyWords: this.keyWord.view,\r\n              pageInfo: this.pageInfo,\r\n              treeInfo: this.treeInfo,\r\n              searchKey: this.usedSearchWords.searchKey,\r\n              sort: this.sortStr,\r\n              reg: this.usedSearchWords.regKey,\r\n              andor: this.usedSearchWords.andor\r\n            })\r\n          }\r\n        } catch (error) {\r\n          console.log(error)\r\n        }\r\n        this.dataList = _.cloneDeep(resp.data.content)\r\n        this.totalSize = resp.data.totalElements\r\n        this.$emit('after-init-data', this.dataList)\r\n        this.$emit('total-size', this.totalSize)\r\n      } catch (error) {\r\n        console.log(error)\r\n        this.loading = false\r\n      }\r\n      this.loading = false\r\n    },\r\n    async initDataList(manual = false) { // manual: 手动刷新按钮\r\n      if (this.autoInit || manual) {\r\n        await this._initDataList()\r\n      }\r\n    },\r\n    // #endregion\r\n    showSearchPanel(flag) {\r\n      this.$forceUpdate()\r\n    },\r\n    auditOnChange(value) {\r\n      this.$emit('audit-on-change', value)\r\n    },\r\n    // #region 按钮相关\r\n    // 按钮新增\r\n    async appendClick() {\r\n      this.$emit('append-click')\r\n    },\r\n    // 按钮修改\r\n    async editClick(row) {\r\n      this.$emit('edit-click', row)\r\n    },\r\n    // #region 按钮删除\r\n    // 删除主函数\r\n    async _deleteClick(row) {\r\n      var ids = row.map(e => e.id)\r\n      await listAPI.delOneOrManyNodes(this.keyWord.edit, ids)\r\n      this._deleteSuccess(ids.size, row)\r\n    },\r\n    // 删除成功后的处理\r\n    async _deleteSuccess(num, row) {\r\n      this.$message.success('删除成功！')\r\n      this.$emit('delete-finish-click', row)\r\n      // 避免删除最后出现分页空白bug\r\n      if ((this.totalSize - num) % this.pageInfo.size === 0 && this.pageInfo.page > 1) {\r\n        this.pageInfo.page--\r\n      }\r\n      this.$refs.table.clearSelection()\r\n      this.initDataList()\r\n    },\r\n    uploadFinish() {\r\n      this.initDataList()\r\n    },\r\n    // 导出按钮\r\n    async _exportClick() {\r\n      await this.$refs['dataTBLMother']._exportData()\r\n    },\r\n    async exportClick() {\r\n      if (Object.prototype.hasOwnProperty.call(this.thisEvents, 'export-click')) {\r\n        this.$emit('export-click')\r\n      } else {\r\n        await this._exportClick()\r\n      }\r\n    },\r\n    // 删除按钮\r\n    async deleteClick(row) {\r\n      if (Object.prototype.hasOwnProperty.call(this.thisEvents, 'delete-click')) {\r\n        this.$emit('delete-click', row)\r\n      } else {\r\n        this._deleteClick(row)\r\n      }\r\n    },\r\n    // 直接点删除时的弹框提示，调用上一层的函数\r\n    remove(row) {\r\n      if (!Object.prototype.hasOwnProperty.call(this.thisEvents, 'spec-remove')) {\r\n        this.$refs['dataTBLMother'].remove(row)\r\n      } else {\r\n        this.$emit('spec-remove', row)\r\n      }\r\n    },\r\n    // #endregion\r\n\r\n    // #region 上移下移\r\n    async _move(row, up) {\r\n      try {\r\n        await listAPI.changeNodeOrder(this.keyWord.edit, row.id, up, this.moveSearchWords.searchKey, this.moveSearchWords.regKey)\r\n        await this.initDataList()\r\n        this.$message.success('移动成功！')\r\n        return true\r\n      } catch (error) {\r\n        console.log(error)\r\n        return false\r\n      }\r\n    },\r\n    // 节点上下移\r\n    async move(row, up) {\r\n      if (up) {\r\n        this.$set(this.buttonLoading, 'up', true)\r\n      } else {\r\n        this.$set(this.buttonLoading, 'down', true)\r\n      }\r\n      if (!Object.prototype.hasOwnProperty.call(this.thisEvents, 'spec-move')) {\r\n        await this._move(row, up)\r\n      } else {\r\n        this.$emit('spec-move', row, up)\r\n      }\r\n      if (up) {\r\n        this.$set(this.buttonLoading, 'up', false)\r\n      } else {\r\n        this.$set(this.buttonLoading, 'down', false)\r\n      }\r\n    },\r\n    // #endregion\r\n\r\n    // #region 按钮审核\r\n    // 审核节点\r\n    async auditClick(row, operName) {\r\n      if (Object.prototype.hasOwnProperty.call(this.thisEvents, 'audit-click')) {\r\n        this.$emit('audit-click', row, operName)\r\n      } else {\r\n        this._audit(row, operName)\r\n      }\r\n    },\r\n    _audit(row, operName) {      \r\n      if (row.length === 1) {        \r\n        this.$parent.openDlg('audit', row[0])\r\n      } else {\r\n        row.forEach(ro => {\r\n          ro.auditUserId = this.$store.getters.userInfo.id\r\n          ro.auditTime = new Date()\r\n          switch (operName) {\r\n            case '批量审核通过':\r\n              ro.isAudit = CONSTANT.AUDIT_STATUS.PASS\r\n              ro.reason = CONSTANT.AUDIT_STATUS.PASSNAME\r\n              break\r\n            case '批量审核不通过':\r\n              ro.isAudit = CONSTANT.AUDIT_STATUS.NOTPASS\r\n              ro.reason = CONSTANT.AUDIT_STATUS.NOTPASSNAME\r\n              break\r\n            case '批量打回':\r\n              ro.isAudit = CONSTANT.AUDIT_STATUS.SAVE\r\n              ro.reason = CONSTANT.AUDIT_STATUS.SAVENAME\r\n              ro.auditTime = null\r\n              break\r\n            case '批量审核退回':\r\n              ro.isAudit = CONSTANT.AUDIT_STATUS.BACK\r\n              ro.reason = CONSTANT.AUDIT_STATUS.BACKNAME\r\n              break\r\n          }\r\n          listAPI.editOneNode(this.keyWord.edit, ro)\r\n        })\r\n      }\r\n    },\r\n    // #endregion\r\n\r\n    // 按钮查询\r\n    searchClick(searchInfo) {\r\n      var searchKey = {}\r\n      var regKey = {}\r\n      if (typeof this.searchName === 'string') {\r\n        this.$set(searchKey, this.searchName, searchInfo)\r\n        this.$set(regKey, this.searchName, CONSTANT.SEARCH_OPERATOR.LIKE)\r\n      // } else {\r\n      //   for (var i=0;i<this.searchName.length;i++) {\r\n      //     this.$set(searchKey, this.searchName[i], searchInfo)\r\n      //     this.$set(regKey, this.searchName[i], CONSTANT.SEARCH_OPERATOR.LIKE)\r\n      //     this.$set(andor, this.searchName[i], false)\r\n      //   }\r\n      //   this.$set(this.nowSearchWords, 'andor', andor)\r\n      }\r\n      this.$set(this.nowSearchWords, 'searchKey', searchKey)\r\n      this.$set(this.nowSearchWords, 'regKey', regKey)\r\n      setTimeout(() => { this.initDataList() }, 500)\r\n    },\r\n    advancedSearchClick(searchInfo) {\r\n      var searchKey = {}\r\n      var regKey = {}\r\n      const keys = Object.keys(searchInfo)\r\n      for (var i = 0; i < keys.length; i++) {\r\n        const item = this.searchItems.filter(item => item.field === keys[i])\r\n        if (item.length > 0) {\r\n          if (item[0].type === 'input') {\r\n            this.$set(searchKey, keys[i], searchInfo[keys[i]])\r\n            this.$set(regKey, keys[i], CONSTANT.SEARCH_OPERATOR.LIKE)\r\n          } else if (item[0].type === 'select') {\r\n            this.$set(searchKey, keys[i], searchInfo[keys[i]])\r\n          } else if (item[0].type === 'date') {\r\n            this.$set(searchKey, keys[i], { beginDate: searchInfo[keys[i]][0], endDate: searchInfo[keys[i]][1] })\r\n            this.$set(regKey, keys[i], CONSTANT.SEARCH_OPERATOR.RANGE)\r\n          }\r\n        }\r\n      }\r\n      this.$set(this.nowSearchWords, 'searchKey', searchKey)\r\n      this.$set(this.nowSearchWords, 'regKey', regKey)\r\n      setTimeout(() => { this.initDataList() }, 500)\r\n    },\r\n    // 更多内容1\r\n    async more1Click(row) {\r\n      this.$emit('more1-click', row)\r\n    },\r\n    // 更多内容2\r\n    async more2Click(row) {\r\n      this.$emit('more2-click', row)\r\n    },\r\n\r\n    // #endregion\r\n\r\n    // 刷新操作\r\n    refreshInit() {\r\n      this.$set(this.nowSearchWords, 'searchKey', {})\r\n      this.$set(this.nowSearchWords, 'regKey', {})\r\n      this.$set(this.nowSearchWords, 'andor', {})\r\n      // console.log(this.initSearchWords)\r\n      // if (!this.search) {\r\n      //\r\n      //   this.$emit('update:regKey', {})\r\n      //   this.$emit('update:searchKey', {})\r\n      //   this.$emit('update:treeInfo', {})\r\n      //   this.$emit('update:topTreeInfo', [])\r\n      //   this.search = false\r\n      //   setTimeout(() => { this.initDataList() }, 500)\r\n      // } else {\r\n      this.initDataList()\r\n      // }\r\n    },\r\n    // 自定义排序\r\n    handleSortChange(column) {\r\n      this.sortStr.properties = column.prop\r\n      if (column.order === 'ascending') {\r\n        this.sortStr.direction = 'ASC'\r\n      } else {\r\n        this.sortStr.direction = 'DESC'\r\n      }\r\n      setTimeout(() => { this.initDataList() }, 500)\r\n    },\r\n    // 监听点击某一行事件\r\n    handleColumnChange(val) {\r\n      if (!this.checkFlag) {\r\n        this.tableRadio = val\r\n        this.selectedColumns = [val]\r\n      }\r\n      this.$emit('update-column', val)\r\n    },\r\n    // 监听选中的事件\r\n    handleSelectionChange(selection) {\r\n      this.selectedColumns = selection\r\n    },\r\n    // 查看节点\r\n    async view(val) {\r\n      this.$emit('view-click', val)\r\n    },\r\n    // 改变页码\r\n    async handleSizeChange(val) {\r\n      this.pageInfo.size = val\r\n      this.isPageInit = true\r\n      await this.initDataList()\r\n      this.isPageInit = false\r\n    },\r\n    async handleCurrentChange(val) {\r\n      this.pageInfo.page = val\r\n      this.isPageInit = true\r\n      await this.initDataList()\r\n      this.isPageInit = false\r\n    }\r\n  }\r\n}\r\n// </script>\r\n// <style scoped lang=\"scss\">\r\n// @import \"~@/assets/css/variables.scss\";\r\n// .primary {\r\n//   background-color: $--color-primary;\r\n//   border-color: $--color-primary;\r\n//   &:hover {\r\n//     opacity: 0.8;\r\n//   }\r\n// }\r\n// ::v-deep .el-card__body {\r\n//   padding: 0;\r\n// }\r\n// .curd-opts {\r\n//   display: -webkit-flex;\r\n//   display: flex;\r\n//   align-items: center;\r\n//   justify-content: space-between;\r\n//   margin-bottom: 10px;\r\n// }\r\n\r\n// .color-yellow {\r\n//   color: #ffb400;\r\n// }\r\n// .color-red {\r\n//   color: #f5585f;\r\n// }\r\n// .color-green {\r\n//   color: #009140;\r\n// }\r\n// .color-blue {\r\n//   color: #1890ff;\r\n// }\r\n\r\n// .button-group {\r\n//   display: flex;\r\n//   justify-content: space-between;\r\n//   width: 100%;\r\n// }\r\n\r\n// .checkbox-item:nth-last-of-type(1) {\r\n//   margin-right: 30px;\r\n// }\r\n// </style>\r\n\r\n"]}]}